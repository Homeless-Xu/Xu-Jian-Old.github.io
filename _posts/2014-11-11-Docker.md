---
layout: post
title: Docker
tags: Misc
categories: ğŸ‘“-Linux
---

## Docker:    [å®˜æ–¹æ–‡æ¡£ä¸­å¿ƒ][1]



`docker run --name mysql -d kali /bin/sh -c "while true; do echo hello world; sleep 1; done`


è¿è¡Œä¸­çš„å®¹å™¨ å¼€ ç»ˆç«¯



*å®¹å™¨é‡å‘½å*
`docker rename old-name new-name`

**è¯¦ç»†å‘½ä»¤ `docker + å›è½¦`

**æŸ¥æ‰¾é•œåƒ:**  
- ç½‘é¡µæŸ¥æ‰¾ [https://hub.docker.com][2] (éœ€è¦æ³¨å†Œ)
	- å‘½ä»¤æŸ¥æ‰¾ `docker search kali`

**ä¸‹è½½é•œåƒ**
`docker pull kalilinux/kali-linux-docker`

**åˆ é™¤é•œåƒ
docker images â†’ rmi ID.   
> èƒ½åˆ é™¤é•œåƒçš„å‰ææ˜¯ æ²¡æœ‰å®¹å™¨ç”¨è¿™ä¸ªé•œåƒ!!! æœ‰äººåœ¨ç”¨(å“ªæ€•é‚£ä¸ªå®¹å™¨ç°åœ¨æ˜¯å…³æœºçš„ä¹Ÿä¸è¡Œ) è‚¯å®šä¸ç»™åˆ é™¤çš„.
**åˆ›å»º/åˆ é™¤ å®¹å™¨
`docker run/rm id`

**å®¹å™¨æ“ä½œ:
`docker start/stop/restart kali`

**åˆ›å»ºäº¤äº’å®¹å™¨:** 
`docker run -t -i kali /bin/bash`
> è¿™é‡Œè¦è¾“å…¥å®Œæ•´çš„ é•œåƒåå­—.
**é‡å‘½åé•œåƒ.
`docker tag kalilinux/kali-linux-docker kali`
> æŠŠå¾ˆé•¿çš„é•œåƒåå­— æ”¹æˆçŸ­çš„.

**å¯åŠ¨å®¹å™¨:**
`docker run kali /bin/bash`
è¿è¡Œä»€ä¹ˆé•œåƒ è¿è¡Œä»€ä¹ˆå‘½ä»¤.
-t æ–°å®¹å™¨å†…æŒ‡å®šä¸€ä¸ªç»ˆç«¯
-i å…è®¸ æˆ‘ä»¬å¯¹å®¹å™¨å†…çš„ STDIN è¿›è¡Œäº¤äº’.
/bin/bash   åœ¨å®¹å™¨å†… å¯åŠ¨ bash è¿™ä¸ª shell.

 ä¸€æ—¦é€€å‡º bash  ä½ çš„å®¹å™¨å°±åœæ­¢äº†!!!


**çœ‹æœ¬åœ°é•œåƒ:
`Docker images`

docker images
REPOSITORY       TAG      IMAGE ID      CREATED      VIRTUAL SIZE
training/webapp  latest   fc77f57ad303  3 weeks ago  280.5 MB
ubuntu           13.10    5e019ab7bf6d  4 weeks ago  180 MB
é•œåƒæº.          é•œåƒæ ‡ç­¾.    é•œåƒ ID

**å®¹å™¨:
`docker ps`

`docker ps -a`  æ‰€æœ‰å®¹å™¨ å“ªæ€•å·²ç»å…³é—­çš„å®¹å™¨


**é‡å‘½åé•œåƒå**            `Â docker tag 468e6235b128 kali:latest` tag + ID + Name:latest   â†’ é»˜è®¤å®˜æ–¹åå­— æ”¹æˆ kali 

**å¼€å…³å¯ Docker**         `Â docker run / stop kali -i -t` ( Contain name ) 
**è¿è¡Œä¸­çš„é•œåƒ**           `Â docker ps` éœ€è¦æ–°å¼€ docker ç»ˆç«¯ æ‰§è¡Œ. 

**ä¿å­˜&å¯åŠ¨ å®¹å™¨**  å…¶å®æ˜¯æ–°åŠ æ ‡ç­¾ ç±»ä¼¼ git . è¦å…»æˆç»™å®¹å™¨æ‰“æ ‡ç­¾çš„ä¹ æƒ¯.

Upgrade Docker
`apt-get upgrade docker-engine`
`service docker status/start`


## Docker é•œåƒ

é•œåƒæ˜¯åŸºç¡€, å¦‚æœæœ¬åœ°ä¸å­˜åœ¨é•œåƒ,ä¼šè‡ªåŠ¨ä» Docker é•œåƒä»“åº“å»ä¸‹è½½.
é•œåƒ ç›¸å½“äº è¿·ä½ æ“ä½œç³»ç»Ÿ.


info:
`docker info`

*Docker IP*
`ip addr`  çœ‹å®¹å™¨ip
`nmap Container IP` æ‰«æå®¹å™¨ç«¯å£.
telnet / ssh å®¹å™¨ IP.
( å‰ææ˜¯ docker å…è®¸ ssh è¿æ¥. é»˜è®¤æ˜¯ä¸å…è®¸çš„.)

*Docker SSH*

- è½»é‡çº§è™šæ‹Ÿæœº! æ˜¯ä¸€ä¸ªè¿›ç¨‹ ä¸æ˜¯ä¸€å°æœºå™¨.
- ä¸¤ä¸ªç¨‹åº  æœåŠ¡ç«¯ å’Œ å®¢æˆ·ç«¯.  æœåŠ¡ç«¯ç®¡ç†æ‰€æœ‰å®¹å™¨.


Docker ä¼šä¸ºæ‰€æœ‰å·²ç»è¿è¡Œï¼ˆåŒ…æ‹¬å·²ç»åœæ­¢ï¼‰çš„å®¹å™¨éšæœºåˆ†é…ä¸€ä¸ªå”¯ä¸€çš„åå­—å’Œä¸€ä¸ªå”¯ä¸€çš„ IDï¼Œ
docker å‘½ä»¤å¯ä»¥è¯†åˆ« IDï¼Œä¹Ÿå¯ä»¥è¯†åˆ«è¿™ä¸ªåå­—ã€‚
	docker ps -a æ¥æ˜¾ç¤º 


æ¯æ¬¡è¿è¡Œ docker run å‘½ä»¤çš„æ—¶å€™ï¼ŒDocker éƒ½ä¼šæ–°å»ºä¸€ä¸ªå”¯ä¸€çš„å®¹å™¨ID ï¼Œ â†’ ä¸åŒçš„å®¹å™¨ æ•°æ®æ˜¯ä¸é€šçš„... 
å·²ç»åœæ­¢çš„å®¹å™¨ é‡Œé¢çš„æ•°æ®ä¸ä¼šæ¶ˆå¤±  ç”¨ docker ps -a æ˜¾ç¤º.

ç°åœ¨æˆ‘ä»¬ä½¿ç”¨ -iï¼ˆäº¤äº’å¼ï¼‰å’Œ -tï¼ˆä¸´æ—¶ç»ˆç«¯ï¼‰å‚æ•°è¿è¡Œä¸€ä¸ªå®¹å™¨ï¼Œç„¶åè¾“å…¥ä¸€äº›äº¤äº’å‘½ä»¤ï¼š

å®¹


# Mac : 

Docker ä¸åŸç”Ÿæ”¯æŒMac â†’ So go å®˜ç½‘*Â Download:  Docker Toolbox* .å¸®ä½ é…ç½®ç¯å¢ƒ. 

ä½¿ç”¨:
- Docker Quickstart Terminal
	// è¿è¡Œ docker å‘½ä»¤ è¦åœ¨è¿™é‡Œè¾“å…¥. å› ä¸º mac ä¸èƒ½æ”¯æŒåŸç”Ÿ docker . éœ€è¦é€šè¿‡è™šæ‹Ÿæœºæ¥å®ç°.

	docker inspect 698 
å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯.


**å¤‡ä»½é•œåƒ**    docker push xujian

**åˆ é™¤å®¹å™¨**   docker rm 43de70a54ec1,æˆ–è€…ç®€å†™æˆ docker rm 43de    æ¥é‡Šæ”¾ç©ºé—´.

åˆ é™¤é•œåƒ: docker rmi xujian
// å¦‚æœæœ‰å®¹å™¨(å³ä¾¿å·²ç»åœæ­¢) å­˜åœ¨.  é‚£ä¹ˆå°±ä¸èƒ½åˆ é™¤é•œåƒ. ä¸ç„¶æš‚åœçš„å®¹å™¨å°±èµ·ä¸æ¥.




æ–°å»º Docker
åˆ‡æ¢åˆ° docker
ç®¡ç†å®¹å™¨

	docker run -it ubuntu bash
	// å°±èƒ½è¿›åˆ° ubuntu çš„ bash äº† èƒ½è¾“å…¥å„ç§å‘½ä»¤.

	docker run ubuntu
	docker â†’ ä½ è¦ä½¿ç”¨ docker
	run  â†’ å¼€å¯ è¿è¡Œ
	ubuntu â†’ é•œåƒåç§° 


æ‰¾åˆ°é•œåƒ:
å» docker å®˜ç½‘çœ‹. 
[https://hub.docker.com/explore/][3]


ä¸‹è½½ mysql
	docker pull mysql

ä¸‹è½½ debian
	docker pull debian
	

åœ¨ docker ä¸­è¿è¡Œ hello world
	docker run debian echo ''hello world''


åœ¨å®¹å™¨ä¸­å®‰è£…ç¨‹åº:



ä¿å­˜å®¹å™¨:
1. æŸ¥çœ‹å®¹å™¨çš„ ID :  docker ps åªéœ€å‰å‡ ä½idå°±å¥½
	docker commit 698 ubuntu


æ¯æ¬¡è¿è¡Œ éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å®¹å™¨.



åˆ é™¤å®¹å™¨:
å…ˆåœæ­¢ å†åˆ é™¤
docker stop ubuntu
docker rm ubuntu






â€”
åŸºæœ¬æ¦‚å¿µ.
é•œåƒ image
å®¹å™¨ container
ä»“åº“ repository


é•œåƒ åªè¯»æ¨¡æ¿.
è‡ªå·±å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ›å»º æ›´æ–° é•œåƒ!!!!


å®¹å™¨;(ç®€æ˜“çš„ linux ç¯å¢ƒ.)
docker åˆ©ç”¨å®¹å™¨è¿è¡Œ. æ˜¯é•œåƒåˆ›å»ºçš„ è¿è¡Œå®ä¾‹.
å¯ä»¥ å¯åŠ¨ å¼€å§‹ åœæ­¢ åˆ é™¤.
æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»çš„.


ä»“åº“:å­˜æ”¾é•œåƒçš„åœ°æ–¹.
ä»“åº“ 
- Public å…¬å¼€ä»“åº“
	//Docker Hub æœ€å¤§çš„å…¬å¼€ä»“åº“.
	- Private ç§æœ‰ä»“åº“

ç”¨æˆ·åˆ›å»ºäº† è‡ªå·±çš„é•œåƒå å¯ä»¥å“Ÿå— push åˆ°ç§æœ‰æˆ–è€…å…¬æœ‰ä»“åº“. åœ¨å¦ä¸€å°ç”µè„‘ç”¨çš„æ—¶å€™ åªè¦.pull ä¸‹æ¥å°±å¥½äº†.








å®¹å™¨:
- åˆ›å»ºæ–°çš„å®¹å™¨    docker run
- é‡å¯å·²åœæ­¢çš„å®¹å™¨. docker start
- å¾ˆå¤šæ—¶å€™ éƒ½æ˜¯éšæ—¶åˆ é™¤ å’Œ åˆ›å»ºæ–°çš„å®¹å™¨.


åå°:
background

-d

**å®¹å™¨æ˜¯å¦ä¼šé•¿ä¹…è¿è¡Œï¼Œæ˜¯å’Œdocker runæŒ‡å®šçš„å‘½ä»¤æœ‰å…³ï¼Œå’Œ -d å‚æ•°æ— å…³ã€‚


æŸ¥çœ‹å®¹å™¨è¾“å‡ºä¿¡æ¯:
`docker logs ID`



å¯¼å‡ºå®¹å™¨:
docker export id \> xxx.rar



**æ ‡è®°é•œåƒ
docker tag xxx xxxxxxxx





docker æ•°æ®ç®¡ç†

- æ•°æ®å·.
	- æ•°æ®å·å®¹å™¨.

æ•°æ®å·:
å¯ä»¥ç»™å¤šä¸ªå®¹å™¨ä½¿ç”¨çš„,å¤šä¸ªå®¹å™¨ä¹‹é—´å…±äº«.

åˆ›å»ºæ•°æ®å·
è¾“å‡ºæ•°æ®å·


æŒ‚è½½æœ¬åœ°æ–‡ä»¶ ä½œä¸ºæ•°æ®å·.






ç½‘ç»œåŠŸèƒ½:


-p æŒ‡å®šç«¯å£æ˜ å°„. åˆ° web ç•Œé¢.


å®¹å™¨äº’è”.


**å®¹å™¨å:
sudo docker run -d -P --name web training/webapp python app.py




docker å¯åŠ¨æ—¶
ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª è™šæ‹Ÿç½‘æ¡¥.(è½¯ä»¶äº¤æ¢æœº)




äº¤äº’å¼å®¹å™¨:
å‘½ä»¤ç»ˆæ­¢äº† å®¹å™¨å°±å…³é—­äº†


**å®ˆæŠ¤å¼å®¹å™¨**

å¯ä»¥é•¿æœŸè¿è¡Œçš„å®¹å™¨.é€‚åˆ è¿è¡Œ åº”ç”¨ç¨‹åº å’Œ æœåŠ¡.!!!! 

 ç”¨ kali é•œåƒ åˆ›å»ºä¸€ä¸ªå« mysql çš„å®¹å™¨.

`docker run --name mysql -d kali /bin/sh -c "while true; do echo hello world; sleep 1; done`

è¿™ä¸ªå®¹å™¨ä¼šåœ¨åå°è¿è¡Œ.
 ç”¨äº†ä¸€ä¸ª  while å¾ªç¯.  ä¼šä¸€ç›´ æ‰“å° helloworld . 

åå°è¿è¡Œçš„å®¹å™¨ å¯ä»¥ç”¨  `docker logs mysql` æŸ¥çœ‹æ—¥å¿—.
æŸ¥çœ‹å®¹å™¨å†…çš„è¿›ç¨‹  `docker top mysql`




*å®¹å™¨çš„æ›´å¤šä¿¡æ¯
docker inspect mysql





æ„å»ºè‡ªå·±çš„é•œåƒ
docker build -t \<é•œåƒå\> \<Dockerfileè·¯å¾„\>
å¦‚Dockerfileåœ¨å½“å‰è·¯å¾„ï¼š
docker build -t xx/gitlab .




æŸ¥çœ‹ä¸»æœº ip ä¿¡æ¯
 docker inspect nginx_dist |grep 172.17
"Gateway": "172.17.42.1",
"IPAddress": "172.17.42.6",













[1]:	https://docs.docker.com
[2]:	https://hub.docker.com
[3]:	https://hub.docker.com/explore/