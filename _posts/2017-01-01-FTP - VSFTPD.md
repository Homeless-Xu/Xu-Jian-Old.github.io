---
layout: post
title: FTP / VSFTPD
tags: 
categories: ğŸ› 
---


## FTP / VSFTPD

> åŒ¿åæœåŠ¡: é»˜è®¤ç”¨æˆ·å Anonymous å¯†ç ç©º

##### FTP ç®€ä»‹ : 

File Transfer Protocol. æ–‡ä»¶ä¼ è¾“åè®® . å±äº åº”ç”¨å±‚  
æ–‡ä»¶å…±äº«ã€è·¨å¹³å°ä½¿ç”¨.(å…¼å®¹å¤šç§ æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿï¼ˆFile system )

##### FTP ç”¨æˆ·è®¤è¯æ–¹å¼:
- åŒ¿åç”¨æˆ· /Â æˆæƒç”¨æˆ· Â 
	- æˆæƒç”¨æˆ·:ç³»ç»Ÿ( æœ¬åœ° )ç”¨æˆ· / è™šæ‹Ÿç”¨æˆ·
		- è™šæ‹Ÿç”¨æˆ·: æœ¬åœ°dbåº“æ–‡ä»¶Â / mysqlæ•°æ®åº“ / LDAP
			// è™šæ‹Ÿç”¨æˆ· å°±æ˜¯ä¸èƒ½å®é™…ç™»å½• Linux åªèƒ½ç™»å½• Ftp çš„è´¦æˆ·.

##### FTP æ¨¡å¼ï¼šä¸»åŠ¨å’Œè¢«åŠ¨ã€‚

- ä¸»åŠ¨æ¨¡å¼:

	å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ åŒæ—¶æ‰“å¼€å¹¶ä¸”ç›‘å¬ä¸€ä¸ªç«¯å£ä»¥åˆ›å»ºè¿æ¥ã€‚
	> å®¢æˆ·ç«¯å®‰è£…äº†é˜²ç«å¢™ä¼šäº§ç”Ÿé—®é¢˜ã€‚æ‰€ä»¥ï¼Œåˆ›ç«‹äº†è¢«åŠ¨æ¨¡å¼ã€‚

- è¢«åŠ¨æ¨¡å¼:

	æœåŠ¡å™¨ç«¯æ‰“å¼€å¹¶ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œä¸ç”¨ç®¡å®¢æˆ·ç«¯çš„é˜²ç«å¢™ã€‚




#### Win7 FTP æœåŠ¡æ­å»º

å®‰è£…:  æ‰“å¼€å…³é—­ windows åŠŸèƒ½:
å®‰è£… FTP æœåŠ¡å™¨ & Web ç®¡ç†å·¥å…· æ‰€æœ‰å­é¡¹

è¿›å…¥: æ§åˆ¶é¢æ¿ ç®¡ç†å·¥å…· â†’  ä¿¡æ¯æœåŠ¡ç®¡ç†å™¨( IIS )









#### VSFTPD : 

Very Secure FTP Daemon (å®ˆæŠ¤è¿›ç¨‹)  
é«˜å®‰å…¨æ€§ã€å°å·§é«˜é€Ÿã€å¸¦å®½é™åˆ¶ã€è™šæ‹Ÿç”¨æˆ·ã€IPv6ã€  
Linuxå‘è¡Œç‰ˆä¸­æœ€å—æ¨å´‡çš„FTPæœåŠ¡å™¨ç¨‹åºã€‚
> ç±»ä¼¼çš„ Linux FTP æœåŠ¡: ProFTPDã€PureFTPdå’Œwuftpdç­‰

##### Debian - Vsftpd å®‰è£…é…ç½®

-  vsftpd å®‰è£…:
	apt-get install vsftpd -y

#### é…ç½® FTPç”¨æˆ·

å®ç°: ç”¨æˆ· xu-jian å¯ä»¥ç™»å½• FTPæœåŠ¡å™¨. ç™»å½•ç›®å½•ä¸º /home/admin

- home ä¸‹ æ–°å»º admin æ–‡ä»¶å¤¹ .
	cd /home  â†’ mkdir admin

- åˆ›å»ºç”¨æˆ·å  + ç”¨æˆ·å¯†ç  + ç™»å½•ç›®å½•
	useradd -d /home/admin xu-jian 
	//å¢åŠ ç”¨æˆ·xu-jianï¼Œå¹¶åˆ¶å®šxujianç”¨æˆ·çš„ä¸»ç›®å½•ä¸º/home/admin
	
	passwd xujian //ä¸ºxu-jianè®¾ç½®å¯†ç 
	//éœ€è¦ Root æƒé™è¿è¡Œ

- ä¿®æ”¹FTPç›®å½•æƒé™
	chown -R xu-jian.xu-jian /home/admin
	//chown -R å‘½ä»¤æ”¹å˜ æ–‡æ¡£/ç›®å½• çš„æ‰€æœ‰è€…ã€‚

- æŸ¥çœ‹æ–‡ä»¶å¤¹æƒé™ â†’ cd home  â†’  ls -l
	drwxr-xr-x 2 xu-jian xu-jian 4096 Mar 16 09:50 admin
	// ç¡®è®¤æ˜¯å¦è®¾ç½®æ­£ç¡®

- æƒé™è®¾ç½®ï¼š

	usermod -s /sbin/nologin xu-jian 
	//é™å®šç”¨æˆ·xu-jianä¸èƒ½telnetï¼Œåªèƒ½ftp
	
	usermod -s /sbin/bash test 
	//ç”¨æˆ·testæ¢å¤æ­£å¸¸
- æ›´æ”¹ç”¨æˆ·ç›®å½•
	usermod -d /test xu-jian 
	//æ›´æ”¹ç”¨æˆ·xu-jiançš„ä¸»ç›®å½•ä¸º/test

- é™åˆ¶ç”¨æˆ·åªèƒ½è®¿é—®/home/test.
	vi /etc/vsftpd/vsftpd.conf

	chroot_list_enable=YES //é™åˆ¶è®¿é—®è‡ªèº«ç›®å½•
	å¼€å¯é™åˆ¶åŠŸèƒ½
	chroot_list_file=/etc/vsftpd/vsftpd.chroot_list
	//  å»æ‰ #   è®¾ç½® é™åˆ¶ç”¨æˆ·åˆ—è¡¨ç›®å½•  â†’ åœ¨ :wq ä¿å­˜é€€å‡º

	æ¥ç€åˆ›å»ºvsftpd.chroot_listæ–‡ä»¶ï¼Œå°†å—é™åˆ¶çš„ç”¨æˆ·æ·»åŠ è¿›å»ï¼Œæ¯ä¸ªç”¨æˆ·åä¸€è¡Œ
	touch /etc/vsftpd.chroot_list && echo xu-jian > /etc/vsftpd.chroot_list

æ”¹å®Œé…ç½®æ–‡ä»¶  â†’ é‡å¯vsftpd æœåŠ¡å™¨
	/etc/init.d/vsftpd restart

#### é…ç½® vsftp 

	vi /etc/vsftpd.conf

##### é…ç½®æ–‡ä»¶ - æœ¬åœ°ç”¨æˆ·è®¾ç½®
	local_enable=YES/NOï¼ˆYESï¼‰
	æ˜¯å¦å…è®¸æœ¬åœ°ç”¨æˆ·ç™»å…¥ï¼ŒYES å…è®¸ï¼ŒNOä¸å…è®¸ã€‚
	
	local_root=/home/username
	æœ¬åœ°ç”¨æˆ·ç™»å…¥æ—¶ï¼Œç™»å½•åˆ°ç›¸åº”çš„ç›®å½•ã€‚é»˜è®¤å€¼ä¸ºå„ç”¨æˆ·çš„å®¶ç›®å½•ã€‚
	
	write_enable=YES/NOï¼ˆYESï¼‰
	ç™»é™†ç”¨æˆ·æœ‰å†™æƒé™ã€‚å±äºå…¨å±€è®¾ç½®ï¼Œé»˜è®¤å€¼ä¸ºYESã€‚
	
	local_umask=022
	æœ¬åœ°ç”¨æˆ·æ–°å¢æ¡£æ¡ˆæ—¶çš„umask å€¼ã€‚é»˜è®¤å€¼ä¸º077ã€‚
	
	Chroot_local_user=yesÂ       æ˜¯å¦å°†ftpæœ¬åœ°ç”¨æˆ·ç¦é”¢åœ¨å®¿ä¸»ç›®å½•é‡ŒÂ 
	
	Local_max_rate=0Â             æœ¬åœ°ç”¨æˆ·æœ€å¤§çš„ä¼ è¾“é€Ÿç‡0ä¸ºä¸é™åˆ¶Â ï¼ˆå•ä½ä¸ºå­—èŠ‚ï¼‰Â 


- æ£€æŸ¥ FTPç›®å½•æƒé™
	ls -a 
	//ftp ç›®å½• èƒ½çœ‹åˆ° å„ç”¨æˆ·çš„è¯»å†™æƒé™.

- æœ€åŸºæœ¬é…ç½®:

	write_enable=YES  æ˜¯å¦å¼€å¯ . è¦ä¸Šä¼ æ–‡ä»¶ å¿…é¡»å¼€å¯.
	
	local_enable=YES    26è¡Œ. å…è®¸ æœåŠ¡å™¨æœ¬åœ°ç³»ç»Ÿç™»å½•.


æ¨¡æ¿ä¸€: ä¸è®¸åŒ¿å.åªè®¸æœ¬åœ°
  
	anonymous_enable=YES â€œ  23 è¡Œ.  æ”¹ä¸º  â€œanonymous_enable=NOâ€
	//ä¸å…è®¸åŒ¿åç™»å½• 

	//åˆ é™¤å¦‚ä¸‹é…ç½®å‰çš„æ³¨é‡Šç¬¦å·(#)ï¼š

	write_enable=YES
	// 29è¡Œ. å…è®¸å†™å…¥æƒé™
	chroot_local_user=YES
	112è¡Œ ç”¨æˆ·å¯ä»¥åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•
	chroot_list_enable=YES
	121è¡Œ å¯ç”¨ list é‡Œé¢çš„ç”¨æˆ·åˆ—è¡¨ 
	chroot_list_file=/etc/vsftpd.chroot_list
	//123è¡Œ å“ªäº›ç”¨æˆ·å¯ä»¥åˆ‡æ¢åˆ°åˆ° ä¸Šçº§ç›®å½•

-  :wq ä¿å­˜é€€å‡º


- å¯åŠ¨ã€å…³é—­ã€é‡å¯ vsftpdæœåŠ¡ï¼š
	service vsftpd start      æˆ–è€… /etc/init.d/vsftpd start 

	service vsftpd stop

	serviceÂ vsftpdÂ restartÂ 

- æŸ¥çœ‹ç«¯å£
	netstat -npl
	å°±èƒ½çœ‹åˆ° 21ç«¯å£å¼€å¯äº†. 
	tcp        0      0 0.0.0.0:21              0.0.0.0:*               LISTEN      12219/vsftpd

##### å…¨å±€é…ç½®ç±»
	Listen=yesÂ Â æ˜¯å¦ä»¥ç‹¬ç«‹è¿è¡Œçš„æ–¹å¼ç›‘å¬æœåŠ¡Â 
	Listen_port=21Â è®¾ç½®ç›‘å¬ftpæœåŠ¡çš„ç«¯å£Â 
	Write_enable=yesÂ å¯ç”¨ä»»ä½•å½¢å¼çš„å†™å…¥æƒé™ï¼ˆå¦‚ä¸Šä¼ Â åˆ é™¤æ–‡ä»¶ç­‰ï¼‰Â éƒ½éœ€è¦å¼€å¯æ­¤é¡¹Â 
	Download_enable=yesÂ æ˜¯å¦å…è®¸ä¸‹è½½æ–‡ä»¶ï¼ˆå»ºç«‹ä»…é™äºæµè§ˆï¼Œä¸Šä¼ çš„ftpæœåŠ¡å™¨æ˜¯æ­¤é¡¹å¯è®¾ä¸ºNOï¼‰Â 
	Dirmessage_enable=yesÂ ç”¨æˆ·åˆ‡æ¢è¿›å…¥ç›®å½•æ—¶æ˜¾ç¤ºmessageæ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰çš„å†…å®¹Â 
	Xferlog_enable=yesÂ å¯ç”¨xferlogæ—¥å¿—Â é»˜è®¤è®°å½•åˆ°/var/log/xferlogæ–‡ä»¶Â 
	Xferlog_std_format=yesÂ å¯ç”¨æ ‡å‡†çš„xferlogæ—¥å¿—æ ¼å¼,è‹¥ç¦ç”¨æ­¤é¡¹,å°†ä½¿ç”¨vsftpdè‡ªå·±çš„æ—¥å¿—æ ¼å¼
	Connect_from_Port_20=yesÂ å…è®¸æœåŠ¡å™¨ä¸»åŠ¨æ¨¡å¼(ä»20ç«¯å£å»ºç«‹æ•°æ®è¿æ¥)Â 
	Pasv_enable=yesÂ å…è®¸è¢«åŠ¨æ¨¡å¼è¿æ¥Â 
	Pasv_max_port=24600Â è®¾ç½®ç”¨äºè¢«åŠ¨æ¨¡å¼çš„æœåŠ¡å™¨çš„æœ€å¤§ç«¯å£å·Â 
	Pasv_Â min_port=24500Â è®¾ç½®ç”¨äºè¢«åŠ¨æ¨¡å¼çš„æœåŠ¡å™¨çš„æœ€å°ç«¯å£å·Â 
	Pam_Service_name=vsftpdÂ è®¾ç½®ç”¨äºç”¨æˆ·è®¤è¯çš„PAMæ–‡ä»¶ä½ç½®Â 
	Userlist_enable=yesÂ æ˜¯å¦å¯ç”¨use_listç”¨æˆ·åˆ—è¡¨æ–‡ä»¶Â 
	Userlist_deny=yesÂ æ˜¯å¦ç¦æ­¢user_listç”¨æˆ·åˆ—è¡¨ä¸­çš„ç”¨æˆ·Â 
	Max_clients=0Â æœ€å¤šå…è®¸å¤šå°‘ä¸ªå®¢æˆ·ç«¯åŒæ—¶è¿æ¥(0ä¸ºæ— é™åˆ¶)Â 
	Max_per_ip=0Â å¯¹æ¥è‡ªç›¸åŒipåœ°å€çš„å®¢æˆ·ç«¯æœ€å¤šå…è®¸å¤šå°‘ä¸ªå¹¶å‘è¿æ¥æ•°(0Â ä¸ºæ— é™åˆ¶)Â 
	Tcp_wrappers=yesÂ æ˜¯å¦å¯ç”¨tcp_wrappersÂ æœºåˆ¶Â 




##### åŒ¿åç”¨æˆ·ç±»è®¾ç½®
	Anonymous_enable=yesÂ æ˜¯å¦å…è®¸åŒ¿åç”¨æˆ·è®¿é—®Â 
	Anon_umask=022Â è®¾ç½®åŒ¿åç”¨æˆ·æ‰€ä¸Šä¼ æ–‡ä»¶çš„é»˜è®¤æƒé™æ©ç 
	Anon_root=/var/ftpÂ è®¾ç½®åŒ¿åç”¨æˆ·çš„ftpæ ¹ç›®å½•(ä¸è®¾ç½®é»˜è®¤åœ¨/var/ftpç›®å½•ä¸‹)Â 
	Anon_upload_enable=yesÂ æ˜¯å¦å…è®¸åŒ¿åç”¨æˆ·ä¸Šä¼ æ–‡ä»¶Â 
	Anon_mkdir_write_enable=yesÂ æ˜¯å¦å…è®¸åŒ¿åç”¨æˆ·åˆ›å»ºç›®å½•çš„å†™å…¥æƒé™Â 
	Anon_other_write_enable=yesÂ æ˜¯å¦å…è®¸åŒ¿åç”¨æˆ·æœ‰å…¶å®ƒå†™å…¥æƒé™å¦‚:æ”¹åè¦†ç›–åŠåˆ é™¤
	Anon_max_rate=0Â é™åˆ¶åŒ¿åç”¨æˆ·æœ€å¤šä¼ è¾“é€Ÿç‡0ä¸ºä¸é™åˆ¶Â 


#### åŒ¿åç”¨æˆ·ï¼ˆanonymousï¼‰è®¾ç½®
	anonymous_enable=YES/NOï¼ˆYESï¼‰
æ§åˆ¶æ˜¯å¦å…è®¸åŒ¿åç”¨æˆ·ç™»å…¥ï¼ŒYES ä¸ºå…è®¸åŒ¿åç™»å…¥ï¼ŒNO ä¸ºä¸å…è®¸ã€‚é»˜è®¤å€¼ä¸ºYESã€‚
	write_enable=YES/NOï¼ˆYESï¼‰
æ˜¯å¦å…è®¸ç™»é™†ç”¨æˆ·æœ‰å†™æƒé™ã€‚å±äºå…¨å±€è®¾ç½®ï¼Œé»˜è®¤å€¼ä¸ºYESã€‚
	no_anon_password=YES/NOï¼ˆNOï¼‰
è‹¥æ˜¯å¯åŠ¨è¿™é¡¹åŠŸèƒ½ï¼Œåˆ™ä½¿ç”¨åŒ¿åç™»å…¥æ—¶ï¼Œä¸ä¼šè¯¢é—®å¯†ç ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
	ftp_username=ftp
å®šä¹‰åŒ¿åç™»å…¥çš„ä½¿ç”¨è€…åç§°ã€‚é»˜è®¤å€¼ä¸ºftpã€‚
	anon_root=/var/ftp
ä½¿ç”¨åŒ¿åç™»å…¥æ—¶ï¼Œæ‰€ç™»å…¥çš„ç›®å½•ã€‚é»˜è®¤å€¼ä¸º/var/ftpã€‚æ³¨æ„ftpç›®å½•ä¸èƒ½æ˜¯777çš„æƒé™å±æ€§ï¼Œå³åŒ¿åç”¨æˆ·çš„å®¶ç›®å½•ä¸èƒ½æœ‰777çš„æƒé™ã€‚
	anon_upload_enable=YES/NOï¼ˆNOï¼‰
å¦‚æœè®¾ä¸ºYESï¼Œåˆ™å…è®¸åŒ¿åç™»å…¥è€…æœ‰ä¸Šä¼ æ–‡ä»¶ï¼ˆéç›®å½•ï¼‰çš„æƒé™ï¼Œåªæœ‰åœ¨write\_enable=YESæ—¶ï¼Œæ­¤é¡¹æ‰æœ‰æ•ˆã€‚å½“ç„¶ï¼ŒåŒ¿åç”¨æˆ·å¿…é¡»è¦æœ‰å¯¹ä¸Šå±‚ç›®å½•çš„å†™å…¥æƒã€‚é»˜è®¤å€¼ä¸ºNOã€‚
	anon_world_readable_only=YES/NOï¼ˆYESï¼‰
å¦‚æœè®¾ä¸ºYESï¼Œåˆ™å…è®¸åŒ¿åç™»å…¥è€…ä¸‹è½½å¯é˜…è¯»çš„æ¡£æ¡ˆï¼ˆå¯ä»¥ä¸‹è½½åˆ°æœ¬æœºé˜…è¯»ï¼Œä¸èƒ½ç›´æ¥åœ¨FTPæœåŠ¡å™¨ä¸­æ‰“å¼€é˜…è¯»ï¼‰ã€‚é»˜è®¤å€¼ä¸ºYESã€‚
	anon_mkdir_write_enable=YES/NOï¼ˆNOï¼‰
å¦‚æœè®¾ä¸ºYESï¼Œåˆ™å…è®¸åŒ¿åç™»å…¥è€…æœ‰æ–°å¢ç›®å½•çš„æƒé™ï¼Œåªæœ‰åœ¨write\_enable=YESæ—¶ï¼Œæ­¤é¡¹æ‰æœ‰æ•ˆã€‚å½“ç„¶ï¼ŒåŒ¿åç”¨æˆ·å¿…é¡»è¦æœ‰å¯¹ä¸Šå±‚ç›®å½•çš„å†™å…¥æƒã€‚é»˜è®¤å€¼ä¸ºNOã€‚
	anon_other_write_enable=YES/NOï¼ˆNOï¼‰
å¦‚æœè®¾ä¸ºYESï¼Œåˆ™å…è®¸åŒ¿åç™»å…¥è€…æ›´å¤šäºä¸Šä¼ æˆ–è€…å»ºç«‹ç›®å½•ä¹‹å¤–çš„æƒé™ï¼Œè­¬å¦‚åˆ é™¤æˆ–è€…é‡å‘½åã€‚ï¼ˆå¦‚æœanon\_upload\_enable=NOï¼Œåˆ™åŒ¿åç”¨æˆ·ä¸èƒ½ä¸Šä¼ æ–‡ä»¶ï¼Œä½†å¯ä»¥åˆ é™¤æˆ–è€…é‡å‘½åå·²ç»å­˜åœ¨çš„æ–‡ä»¶ï¼›å¦‚æœanon\_mkdir\_write\_enable=NOï¼Œåˆ™åŒ¿åç”¨æˆ·ä¸èƒ½ä¸Šä¼ æˆ–è€…æ–°å»ºæ–‡ä»¶å¤¹ï¼Œä½†å¯ä»¥åˆ é™¤æˆ–è€…é‡å‘½åå·²ç»å­˜åœ¨çš„æ–‡ä»¶å¤¹ã€‚ï¼‰é»˜è®¤å€¼ä¸ºNOã€‚
	chown_uploads=YES/NOï¼ˆNOï¼‰
è®¾ç½®æ˜¯å¦æ”¹å˜åŒ¿åç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ï¼ˆéç›®å½•ï¼‰çš„å±ä¸»ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
	chown_username=username
è®¾ç½®åŒ¿åç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ï¼ˆéç›®å½•ï¼‰çš„å±ä¸»åã€‚å»ºè®®ä¸è¦è®¾ç½®ä¸ºrootã€‚
	anon_umask=077
è®¾ç½®åŒ¿åç™»å…¥è€…æ–°å¢æˆ–ä¸Šä¼ æ¡£æ¡ˆæ—¶çš„umask å€¼ã€‚é»˜è®¤å€¼ä¸º077ï¼Œåˆ™æ–°å»ºæ¡£æ¡ˆçš„å¯¹åº”æƒé™ä¸º700ã€‚
	deny_email_enable=YES/NOï¼ˆNOï¼‰
è‹¥æ˜¯å¯åŠ¨è¿™é¡¹åŠŸèƒ½ï¼Œåˆ™å¿…é¡»æä¾›ä¸€ä¸ªæ¡£æ¡ˆ/etc/vsftpd/banner\_emailsï¼Œå†…å®¹ä¸ºemail addressã€‚è‹¥æ˜¯ä½¿ç”¨åŒ¿åç™»å…¥ï¼Œåˆ™ä¼šè¦æ±‚è¾“å…¥email addressï¼Œè‹¥è¾“å…¥çš„email address åœ¨æ­¤æ¡£æ¡ˆå†…ï¼Œåˆ™ä¸å…è®¸è¿›å…¥ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
	banned_email_file=/etc/vsftpd/banner_emails
æ­¤æ–‡ä»¶ç”¨æ¥è¾“å…¥email addressï¼Œåªæœ‰åœ¨deny\_email\_enable=YESæ—¶ï¼Œæ‰ä¼šä½¿ç”¨åˆ°æ­¤æ¡£æ¡ˆã€‚è‹¥æ˜¯ä½¿ç”¨åŒ¿åç™»å…¥ï¼Œåˆ™ä¼šè¦æ±‚è¾“å…¥email addressï¼Œè‹¥è¾“å…¥çš„email address åœ¨æ­¤æ¡£æ¡ˆå†…ï¼Œåˆ™ä¸å…è®¸è¿›å…¥ã€‚
Â 

Â 
#### æ¬¢è¿è¯­è®¾ç½®
//dirmessage\_enable=YES/NOï¼ˆYESï¼‰
å¦‚æœå¯åŠ¨è¿™ä¸ªé€‰é¡¹ï¼Œé‚£ä¹ˆä½¿ç”¨è€…ç¬¬ä¸€æ¬¡è¿›å…¥ä¸€ä¸ªç›®å½•æ—¶ï¼Œä¼šæ£€æŸ¥è¯¥ç›®å½•ä¸‹æ˜¯å¦æœ‰.messageè¿™ä¸ªæ¡£æ¡ˆï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä¼šå‡ºç°æ­¤æ¡£æ¡ˆçš„å†…å®¹ï¼Œé€šå¸¸è¿™ä¸ªæ¡£æ¡ˆä¼šæ”¾ç½®æ¬¢è¿è¯è¯­ï¼Œæˆ–æ˜¯å¯¹è¯¥ç›®å½•çš„è¯´æ˜ã€‚é»˜è®¤å€¼ä¸ºå¼€å¯ã€‚
	message_file=.message
è®¾ç½®ç›®å½•æ¶ˆæ¯æ–‡ä»¶ï¼Œå¯å°†è¦æ˜¾ç¤ºçš„ä¿¡æ¯å†™å…¥è¯¥æ–‡ä»¶ã€‚é»˜è®¤å€¼ä¸º.messageã€‚
	banner_file=/etc/vsftpd/banner
å½“ä½¿ç”¨è€…ç™»å…¥æ—¶ï¼Œä¼šæ˜¾ç¤ºæ­¤è®¾å®šæ‰€åœ¨çš„æ¡£æ¡ˆå†…å®¹ï¼Œé€šå¸¸ä¸ºæ¬¢è¿è¯è¯­æˆ–æ˜¯è¯´æ˜ã€‚é»˜è®¤å€¼ä¸ºæ— ã€‚å¦‚æœæ¬¢è¿ä¿¡æ¯è¾ƒå¤šï¼Œåˆ™ä½¿ç”¨è¯¥é…ç½®é¡¹ã€‚
	ftpd_banner=Welcome to BOB's FTP server
è¿™é‡Œç”¨æ¥å®šä¹‰æ¬¢è¿è¯è¯­çš„å­—ç¬¦ä¸²ï¼Œbanner\_fileæ˜¯æ¡£æ¡ˆçš„å½¢å¼ï¼Œè€Œftpd\_banner åˆ™æ˜¯å­—ç¬¦ä¸²çš„å½¢å¼ã€‚é¢„è®¾ä¸ºæ— ã€‚
Â 
#### æ§åˆ¶ç”¨æˆ·æ˜¯å¦å…è®¸åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•

åœ¨é»˜è®¤é…ç½®ä¸‹ï¼Œæœ¬åœ°ç”¨æˆ·ç™»å…¥FTPåå¯ä»¥ä½¿ç”¨cdå‘½ä»¤åˆ‡æ¢åˆ°å…¶ä»–ç›®å½•ï¼Œè¿™æ ·ä¼šå¯¹ç³»ç»Ÿå¸¦æ¥å®‰å…¨éšæ‚£ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰æ¡é…ç½®æ–‡ä»¶æ¥æ§åˆ¶ç”¨æˆ·åˆ‡æ¢ç›®å½•ã€‚
	chroot_list_enable=YES/NOï¼ˆNOï¼‰
è®¾ç½®æ˜¯å¦å¯ç”¨chroot\_list\_fileé…ç½®é¡¹æŒ‡å®šçš„ç”¨æˆ·åˆ—è¡¨æ–‡ä»¶ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
	chroot_list_file=/etc/vsftpd.chroot_list
ç”¨äºæŒ‡å®šç”¨æˆ·åˆ—è¡¨æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ç”¨äºæ§åˆ¶å“ªäº›ç”¨æˆ·å¯ä»¥åˆ‡æ¢åˆ°ç”¨æˆ·å®¶ç›®å½•çš„ä¸Šçº§ç›®å½•ã€‚
	chroot_local_user=YES/NOï¼ˆNOï¼‰
ç”¨äºæŒ‡å®šç”¨æˆ·åˆ—è¡¨æ–‡ä»¶ä¸­çš„ç”¨æˆ·æ˜¯å¦å…è®¸åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½•ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
é€šè¿‡æ­é…èƒ½å®ç°ä»¥ä¸‹å‡ ç§æ•ˆæœï¼š
â‘ å½“chroot\_list\_enable=YESï¼Œchroot\_local\_user=YESæ—¶ï¼Œåœ¨/etc/vsftpd.chroot\_listæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç”¨æˆ·ï¼Œå¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–ç›®å½•ï¼›æœªåœ¨æ–‡ä»¶ä¸­åˆ—å‡ºçš„ç”¨æˆ·ï¼Œä¸èƒ½åˆ‡æ¢åˆ°å…¶ä»–ç›®å½•ã€‚
â‘¡å½“chroot\_list\_enable=YESï¼Œchroot\_local\_user=NOæ—¶ï¼Œåœ¨/etc/vsftpd.chroot\_listæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç”¨æˆ·ï¼Œä¸èƒ½åˆ‡æ¢åˆ°å…¶ä»–ç›®å½•ï¼›æœªåœ¨æ–‡ä»¶ä¸­åˆ—å‡ºçš„ç”¨æˆ·ï¼Œå¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–ç›®å½•ã€‚
â‘¢å½“chroot\_list\_enable=NOï¼Œchroot\_local\_user=YESæ—¶ï¼Œæ‰€æœ‰çš„ç”¨æˆ·å‡ä¸èƒ½åˆ‡æ¢åˆ°å…¶ä»–ç›®å½•ã€‚
â‘£å½“chroot\_list\_enable=NOï¼Œchroot\_local\_user=NOæ—¶ï¼Œæ‰€æœ‰çš„ç”¨æˆ·å‡å¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–ç›®å½•ã€‚
Â 
#### æ•°æ®ä¼ è¾“æ¨¡å¼è®¾ç½®

FTPåœ¨ä¼ è¾“æ•°æ®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨äºŒè¿›åˆ¶æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ASCIIæ¨¡å¼æ¥ä¸Šä¼ æˆ–ä¸‹è½½æ•°æ®ã€‚
	ascii_upload_enable=YES/NOï¼ˆNOï¼‰
è®¾ç½®æ˜¯å¦å¯ç”¨ASCII æ¨¡å¼ä¸Šä¼ æ•°æ®ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
	ascii_download_enable=YES/NOï¼ˆNOï¼‰
è®¾ç½®æ˜¯å¦å¯ç”¨ASCII æ¨¡å¼ä¸‹è½½æ•°æ®ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
Â 
#### è®¿é—®æ§åˆ¶è®¾ç½®

ä¸¤ç§æ§åˆ¶æ–¹å¼ï¼šä¸€ç§æ§åˆ¶ä¸»æœºè®¿é—®ï¼Œå¦ä¸€ç§æ§åˆ¶ç”¨æˆ·è®¿é—®ã€‚

â‘ æ§åˆ¶ä¸»æœºè®¿é—®ï¼š
tcp\_wrappers=YES/NOï¼ˆYESï¼‰
è®¾ç½®vsftpdæ˜¯å¦ä¸tcp wrapperç›¸ç»“åˆæ¥è¿›è¡Œä¸»æœºçš„è®¿é—®æ§åˆ¶ã€‚é»˜è®¤å€¼ä¸ºYESã€‚å¦‚æœå¯ç”¨ï¼Œåˆ™vsftpdæœåŠ¡å™¨ä¼šæ£€æŸ¥/etc/hosts.allow å’Œ/etc/hosts.deny ä¸­çš„è®¾ç½®ï¼Œæ¥å†³å®šè¯·æ±‚è¿æ¥çš„ä¸»æœºï¼Œæ˜¯å¦å…è®¸è®¿é—®è¯¥FTPæœåŠ¡å™¨ã€‚è¿™ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥èµ·åˆ°ç®€æ˜“çš„é˜²ç«å¢™åŠŸèƒ½ã€‚
æ¯”å¦‚ï¼šè‹¥è¦ä»…å…è®¸192.168.0.1â€”192.168.0.254çš„ç”¨æˆ·å¯ä»¥è¿æ¥FTPæœåŠ¡å™¨ï¼Œåˆ™åœ¨/etc/hosts.allowæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
vsftpd:192.168.0. :allow
all:all :deny
â‘¡æ§åˆ¶ç”¨æˆ·è®¿é—®ï¼š
å¯¹äºç”¨æˆ·çš„è®¿é—®æ§åˆ¶å¯ä»¥é€šè¿‡/etcç›®å½•ä¸‹çš„vsftpd.user\_listå’Œftpusersæ–‡ä»¶æ¥å®ç°ã€‚
userlist\_file=/etc/vsftpd.user\_list
æ§åˆ¶ç”¨æˆ·è®¿é—®FTPçš„æ–‡ä»¶ï¼Œé‡Œé¢å†™ç€ç”¨æˆ·åç§°ã€‚ä¸€ä¸ªç”¨æˆ·åç§°ä¸€è¡Œã€‚

userlist\_enable=YES/NOï¼ˆNOï¼‰
æ˜¯å¦å¯ç”¨vsftpd.user\_listæ–‡ä»¶ã€‚
userlist\_deny=YES/NOï¼ˆYESï¼‰
å†³å®švsftpd.user\_listæ–‡ä»¶ä¸­çš„ç”¨æˆ·æ˜¯å¦èƒ½å¤Ÿè®¿é—®FTPæœåŠ¡å™¨ã€‚è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™vsftpd.user\_listæ–‡ä»¶ä¸­çš„ç”¨æˆ·ä¸å…è®¸è®¿é—®FTPï¼Œè‹¥è®¾ç½®ä¸ºNOï¼Œåˆ™åªæœ‰vsftpd.user\_listæ–‡ä»¶ä¸­çš„ç”¨æˆ·æ‰èƒ½è®¿é—®FTPã€‚
/etc/vsftpd/ftpusersæ–‡ä»¶ä¸“é—¨ç”¨äºå®šä¹‰ä¸å…è®¸è®¿é—®FTPæœåŠ¡å™¨çš„ç”¨æˆ·åˆ—è¡¨ï¼ˆæ³¨æ„:å¦‚æœuserlist\_enable=YES,userlist\_deny=NO,æ­¤æ—¶å¦‚æœåœ¨vsftpd.user\_listå’Œftpusersä¸­éƒ½æœ‰æŸä¸ªç”¨æˆ·æ—¶ï¼Œé‚£ä¹ˆè¿™ä¸ªç”¨æˆ·æ˜¯ä¸èƒ½å¤Ÿè®¿é—®FTPçš„ï¼Œå³ftpusersçš„ä¼˜å…ˆçº§è¦é«˜ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹vsftpd.user\_listå’Œftpusersï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶å·²ç»é¢„è®¾ç½®äº†ä¸€äº›ä¸å…è®¸è®¿é—®FTPæœåŠ¡å™¨çš„ç³»ç»Ÿå†…éƒ¨è´¦æˆ·ã€‚å¦‚æœç³»ç»Ÿæ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆæ–°å»ºè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå°†ç”¨æˆ·æ·»åŠ è¿›å»å³å¯ã€‚
Â 
#### è®¿é—®é€Ÿç‡è®¾ç½®
	anon_max_rate=0
è®¾ç½®åŒ¿åç™»å…¥è€…ä½¿ç”¨çš„æœ€å¤§ä¼ è¾“é€Ÿåº¦ï¼Œå•ä½ä¸ºB/sï¼Œ0 è¡¨ç¤ºä¸é™åˆ¶é€Ÿåº¦ã€‚é»˜è®¤å€¼ä¸º0ã€‚
	local_max_rate=0
æœ¬åœ°ç”¨æˆ·ä½¿ç”¨çš„æœ€å¤§ä¼ è¾“é€Ÿåº¦ï¼Œå•ä½ä¸ºB/sï¼Œ0 è¡¨ç¤ºä¸é™åˆ¶é€Ÿåº¦ã€‚é¢„è®¾å€¼ä¸º0ã€‚
Â 
#### è¶…æ—¶è®¾ç½®
	accept_timeout=60
è®¾ç½®å»ºç«‹FTPè¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚é»˜è®¤å€¼ä¸º60ã€‚
	connect_timeout=60
PORT æ–¹å¼ä¸‹å»ºç«‹æ•°æ®è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚é»˜è®¤å€¼ä¸º60ã€‚
	data_connection_timeout=120
è®¾ç½®å»ºç«‹FTPæ•°æ®è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚é»˜è®¤å€¼ä¸º120ã€‚
	idle_session_timeout=300
è®¾ç½®å¤šé•¿æ—¶é—´ä¸å¯¹FTPæœåŠ¡å™¨è¿›è¡Œä»»ä½•æ“ä½œï¼Œåˆ™æ–­å¼€è¯¥FTPè¿æ¥ï¼Œå•ä½ä¸ºç§’ã€‚é»˜è®¤å€¼ä¸º300 ã€‚
Â 
#### æ—¥å¿—æ–‡ä»¶è®¾ç½®
	xferlog_enable= YES/NOï¼ˆYESï¼‰
æ˜¯å¦å¯ç”¨ä¸Šä¼ /ä¸‹è½½æ—¥å¿—è®°å½•ã€‚å¦‚æœå¯ç”¨ï¼Œåˆ™ä¸Šä¼ ä¸ä¸‹è½½çš„ä¿¡æ¯å°†è¢«å®Œæ•´çºªå½•åœ¨xferlog\_file æ‰€å®šä¹‰çš„æ¡£æ¡ˆä¸­ã€‚é¢„è®¾ä¸ºå¼€å¯ã€‚
	xferlog_file=/var/log/vsftpd.log
è®¾ç½®æ—¥å¿—æ–‡ä»¶åå’Œè·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º/var/log/vsftpd.logã€‚
	xferlog_std_format=YES/NOï¼ˆNOï¼‰
å¦‚æœå¯ç”¨ï¼Œåˆ™æ—¥å¿—æ–‡ä»¶å°†ä¼šå†™æˆxferlogçš„æ ‡å‡†æ ¼å¼ï¼Œå¦‚åŒwu-ftpd ä¸€èˆ¬ã€‚é»˜è®¤å€¼ä¸ºå…³é—­ã€‚
	log_ftp_protocol=YES|NOï¼ˆNOï¼‰ 
å¦‚æœå¯ç”¨æ­¤é€‰é¡¹ï¼Œæ‰€æœ‰çš„FTPè¯·æ±‚å’Œå“åº”éƒ½ä¼šè¢«è®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œé»˜è®¤æ—¥å¿—æ–‡ä»¶åœ¨/var/log/vsftpd.logã€‚å¯ç”¨æ­¤é€‰é¡¹æ—¶ï¼Œxferlog\_std\_formatä¸èƒ½è¢«æ¿€æ´»ã€‚è¿™ä¸ªé€‰é¡¹æœ‰åŠ©äºè°ƒè¯•ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
Â 
#### å®šä¹‰ç”¨æˆ·é…ç½®æ–‡ä»¶

åœ¨vsftpdä¸­ï¼Œå¯ä»¥é€šè¿‡å®šä¹‰ç”¨æˆ·é…ç½®æ–‡ä»¶æ¥å®ç°ä¸åŒçš„ç”¨æˆ·ä½¿ç”¨ä¸åŒçš„é…ç½®ã€‚
	user_config_dir=/etc/vsftpd/userconf
è®¾ç½®ç”¨æˆ·é…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚å½“è®¾ç½®äº†è¯¥é…ç½®é¡¹åï¼Œç”¨æˆ·ç™»é™†æœåŠ¡å™¨åï¼Œç³»ç»Ÿå°±ä¼šåˆ°/etc/vsftpd/userconfç›®å½•ä¸‹ï¼Œè¯»å–ä¸å½“å‰ç”¨æˆ·åç›¸åŒçš„æ–‡ä»¶ï¼Œå¹¶æ ¹æ®æ–‡ä»¶ä¸­çš„é…ç½®å‘½ä»¤ï¼Œå¯¹å½“å‰ç”¨æˆ·è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„é…ç½®ã€‚
ä¾‹å¦‚ï¼šå®šä¹‰user\_config\_dir=/etc/vsftpd/userconfï¼Œä¸”ä¸»æœºä¸Šæœ‰ä½¿ç”¨è€… test1,test2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åœ¨user\_config\_dir çš„ç›®å½•æ–°å¢æ–‡ä»¶åä¸ºtest1å’Œtest2ä¸¤ä¸ªæ–‡ä»¶ã€‚è‹¥æ˜¯test1 ç™»å…¥ï¼Œåˆ™ä¼šè¯»å–user\_config\_dir ä¸‹çš„test1 è¿™ä¸ªæ¡£æ¡ˆå†…çš„è®¾å®šã€‚é»˜è®¤å€¼ä¸ºæ— ã€‚åˆ©ç”¨ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å®ç°å¯¹ä¸åŒç”¨æˆ·è¿›è¡Œè®¿é—®é€Ÿåº¦çš„æ§åˆ¶ï¼Œåœ¨å„ç”¨æˆ·é…ç½®æ–‡ä»¶ä¸­å®šä¹‰local\_max\_rate=XXï¼Œå³å¯ã€‚
Â 
#### FTPçš„å·¥ä½œæ–¹å¼ä¸ç«¯å£è®¾ç½®

FTPæœ‰ä¸¤ç§å·¥ä½œæ–¹å¼ï¼šPORT FTPï¼ˆä¸»åŠ¨æ¨¡å¼ï¼‰å’ŒPASV FTPï¼ˆè¢«åŠ¨æ¨¡å¼ï¼‰
	listen_port=21
è®¾ç½®FTPæœåŠ¡å™¨å»ºç«‹è¿æ¥æ‰€ç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤å€¼ä¸º21ã€‚
	connect_from_port_20=YES/NO
æŒ‡å®šFTPä½¿ç”¨20ç«¯å£è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œé»˜è®¤å€¼ä¸ºYESã€‚
	ftp_data_port=20
è®¾ç½®åœ¨PORTæ–¹å¼ä¸‹ï¼ŒFTPæ•°æ®è¿æ¥ä½¿ç”¨çš„ç«¯å£ï¼Œé»˜è®¤å€¼ä¸º20ã€‚
	pasv_enable=YES/NOï¼ˆYESï¼‰
è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™ä½¿ç”¨PASVå·¥ä½œæ¨¡å¼ï¼›è‹¥è®¾ç½®ä¸ºNOï¼Œåˆ™ä½¿ç”¨PORTæ¨¡å¼ã€‚é»˜è®¤å€¼ä¸ºYESï¼Œå³ä½¿ç”¨PASVå·¥ä½œæ¨¡å¼ã€‚
	pasv_max_port=0
åœ¨PASVå·¥ä½œæ¨¡å¼ä¸‹ï¼Œæ•°æ®è¿æ¥å¯ä»¥ä½¿ç”¨çš„ç«¯å£èŒƒå›´çš„æœ€å¤§ç«¯å£ï¼Œ0 è¡¨ç¤ºä»»æ„ç«¯å£ã€‚é»˜è®¤å€¼ä¸º0ã€‚
	pasv_min_port=0
åœ¨PASVå·¥ä½œæ¨¡å¼ä¸‹ï¼Œæ•°æ®è¿æ¥å¯ä»¥ä½¿ç”¨çš„ç«¯å£èŒƒå›´çš„æœ€å°ç«¯å£ï¼Œ0 è¡¨ç¤ºä»»æ„ç«¯å£ã€‚é»˜è®¤å€¼ä¸º0ã€‚
Â 
#### ä¸è¿æ¥ç›¸å…³çš„è®¾ç½®
listen=YES/NOï¼ˆYESï¼‰
è®¾ç½®vsftpdæœåŠ¡å™¨æ˜¯å¦ä»¥standaloneæ¨¡å¼è¿è¡Œã€‚ä»¥standaloneæ¨¡å¼è¿è¡Œæ˜¯ä¸€ç§è¾ƒå¥½çš„æ–¹å¼ï¼Œæ­¤æ—¶listenå¿…é¡»è®¾ç½®ä¸ºYESï¼Œæ­¤ä¸ºé»˜è®¤å€¼ã€‚å»ºè®®ä¸è¦æ›´æ”¹ï¼Œæœ‰å¾ˆå¤šä¸æœåŠ¡å™¨è¿è¡Œç›¸å…³çš„é…ç½®å‘½ä»¤ï¼Œéœ€è¦åœ¨æ­¤æ¨¡å¼ä¸‹æ‰æœ‰æ•ˆã€‚è‹¥è®¾ç½®ä¸ºNOï¼Œåˆ™vsftpdä¸æ˜¯ä»¥ç‹¬ç«‹çš„æœåŠ¡è¿è¡Œï¼Œè¦å—åˆ°xinetdæœåŠ¡çš„ç®¡æ§ï¼ŒåŠŸèƒ½ä¸Šä¼šå—åˆ°é™åˆ¶ã€‚
max\_clients=0
è®¾ç½®vsftpdå…è®¸çš„æœ€å¤§è¿æ¥æ•°ï¼Œé»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºä¸å—é™åˆ¶ã€‚è‹¥è®¾ç½®ä¸º100æ—¶ï¼Œåˆ™åŒæ—¶å…è®¸æœ‰100ä¸ªè¿æ¥ï¼Œè¶…å‡ºçš„å°†è¢«æ‹’ç»ã€‚åªæœ‰åœ¨standaloneæ¨¡å¼è¿è¡Œæ‰æœ‰æ•ˆã€‚
max\_per\_ip=0
è®¾ç½®æ¯ä¸ªIPå…è®¸ä¸FTPæœåŠ¡å™¨åŒæ—¶å»ºç«‹è¿æ¥çš„æ•°ç›®ã€‚é»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºä¸å—é™åˆ¶ã€‚åªæœ‰åœ¨standaloneæ¨¡å¼è¿è¡Œæ‰æœ‰æ•ˆã€‚
listen\_address=IPåœ°å€
è®¾ç½®FTPæœåŠ¡å™¨åœ¨æŒ‡å®šçš„IPåœ°å€ä¸Šä¾¦å¬ç”¨æˆ·çš„FTPè¯·æ±‚ã€‚è‹¥ä¸è®¾ç½®ï¼Œåˆ™å¯¹æœåŠ¡å™¨ç»‘å®šçš„æ‰€æœ‰IPåœ°å€è¿›è¡Œä¾¦å¬ã€‚åªæœ‰åœ¨standaloneæ¨¡å¼è¿è¡Œæ‰æœ‰æ•ˆã€‚
setproctitle\_enable=YES/NOï¼ˆNOï¼‰
è®¾ç½®æ¯ä¸ªä¸FTPæœåŠ¡å™¨çš„è¿æ¥ï¼Œæ˜¯å¦ä»¥ä¸åŒçš„è¿›ç¨‹è¡¨ç°å‡ºæ¥ã€‚é»˜è®¤å€¼ä¸ºNOï¼Œæ­¤æ—¶ä½¿ç”¨ps aux |grep ftpåªä¼šæœ‰ä¸€ä¸ªvsftpdçš„è¿›ç¨‹ã€‚è‹¥è®¾ç½®ä¸ºYESï¼Œåˆ™æ¯ä¸ªè¿æ¥éƒ½ä¼šæœ‰ä¸€ä¸ªvsftpdçš„è¿›ç¨‹ã€‚
Â 
#### è™šæ‹Ÿç”¨æˆ·è®¾ç½®

è™šæ‹Ÿç”¨æˆ·ä½¿ç”¨PAMè®¤è¯æ–¹å¼ã€‚

pam\_service\_name=vsftpd
è®¾ç½®PAMä½¿ç”¨çš„åç§°ï¼Œé»˜è®¤å€¼ä¸º/etc/pam.d/vsftpdã€‚
guest\_enable= YES/NOï¼ˆNOï¼‰
å¯ç”¨è™šæ‹Ÿç”¨æˆ·ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
guest\_username=ftp
è¿™é‡Œç”¨æ¥æ˜ å°„è™šæ‹Ÿç”¨æˆ·ã€‚é»˜è®¤å€¼ä¸ºftpã€‚
virtual\_use\_local\_privs=YES/NOï¼ˆNOï¼‰
å½“è¯¥å‚æ•°æ¿€æ´»ï¼ˆYESï¼‰æ—¶ï¼Œè™šæ‹Ÿç”¨æˆ·ä½¿ç”¨ä¸æœ¬åœ°ç”¨æˆ·ç›¸åŒçš„æƒé™ã€‚å½“æ­¤å‚æ•°å…³é—­ï¼ˆNOï¼‰æ—¶ï¼Œè™šæ‹Ÿç”¨æˆ·ä½¿ç”¨ä¸åŒ¿åç”¨æˆ·ç›¸åŒçš„æƒé™ã€‚é»˜è®¤æƒ…å†µä¸‹æ­¤å‚æ•°æ˜¯å…³é—­çš„ï¼ˆNOï¼‰ã€‚
Â 
16.å…¶ä»–è®¾ç½®
text\_userdb\_names= YES/NOï¼ˆNOï¼‰
è®¾ç½®åœ¨æ‰§è¡Œls â€“laä¹‹ç±»çš„å‘½ä»¤æ—¶ï¼Œæ˜¯æ˜¾ç¤ºUIDã€GIDè¿˜æ˜¯æ˜¾ç¤ºå‡ºå…·ä½“çš„ç”¨æˆ·åå’Œç»„åã€‚é»˜è®¤å€¼ä¸ºNOï¼Œå³ä»¥UIDå’ŒGIDæ–¹å¼æ˜¾ç¤ºã€‚è‹¥å¸Œæœ›æ˜¾ç¤ºç”¨æˆ·åå’Œç»„åï¼Œåˆ™è®¾ç½®ä¸ºYESã€‚
ls\_recurse\_enable=YES/NOï¼ˆNOï¼‰
è‹¥æ˜¯å¯ç”¨æ­¤åŠŸèƒ½ï¼Œåˆ™å…è®¸ç™»å…¥è€…ä½¿ç”¨ls â€“Rï¼ˆå¯ä»¥æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹å­ç›®å½•ä¸­çš„æ–‡ä»¶ï¼‰è¿™ä¸ªæŒ‡ä»¤ã€‚é»˜è®¤å€¼ä¸ºNOã€‚
hide\_ids=YES/NOï¼ˆNOï¼‰
å¦‚æœå¯ç”¨æ­¤åŠŸèƒ½ï¼Œæ‰€æœ‰æ¡£æ¡ˆçš„æ‹¥æœ‰è€…ä¸ç¾¤ç»„éƒ½ä¸ºftpï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨è€…ç™»å…¥ä½¿ç”¨ls -alä¹‹ç±»çš„æŒ‡ä»¤ï¼Œæ‰€çœ‹åˆ°çš„æ¡£æ¡ˆæ‹¥æœ‰è€…è·Ÿç¾¤ç»„å‡ä¸ºftpã€‚é»˜è®¤å€¼ä¸ºå…³é—­ã€‚
download\_enable=YES/NOï¼ˆYESï¼‰
å¦‚æœè®¾ç½®ä¸ºNOï¼Œæ‰€æœ‰çš„æ–‡ä»¶éƒ½ä¸èƒ½ä¸‹è½½åˆ°æœ¬åœ°ï¼Œæ–‡ä»¶å¤¹ä¸å—å½±å“ã€‚é»˜è®¤å€¼ä¸ºYESã€‚










---- -




äºŒã€ftpç”¨æˆ·é…ç½®
1.å…ˆæ£€æŸ¥ä¸€ä¸‹nologinçš„ä½ç½®ï¼Œé€šå¸¸æ˜¯/usr/sbin/nologinæˆ–è€…/sbin/nologinã€‚
2.æ¥ç€åˆ›å»ºç³»ç»Ÿè´¦æˆ·
# useradd -d /home/www/ftproot -s /usr/sbin/nologin ftpuser  
/home/www/ftproot ä¸ºè¯¥ç³»ç»Ÿç”¨æˆ·å®¶(home)ç›®å½•ï¼Œftpuserä¸ºç”¨æˆ·å  
ä¸ºè¯¥å¸æˆ·è®¾ç½®å¯†ç :  
#passwd ftpuser  
è¾“å…¥ä¸¤æ¬¡ç›¸åŒå¯†ç å³å¯
3.ç„¶åä¿®æ”¹æŒ‡å®šç›®å½•çš„æƒé™
# chown -R ftpuser.ftpuser /home/www/ftproot  
chown -Rå‘½ä»¤æ”¹å˜æ–‡æ¡£/ç›®å½•æ‰€æœ‰è€…ã€‚è¯¦è§£
4.é…ç½®vsftp
ç¼–è¾‘vsftpé…ç½®æ–‡ä»¶ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š  
#vi /etc/vsftpd.conf  
å°†é…ç½®æ–‡ä»¶ä¸­â€anonymous_enable=YES â€œæ”¹ä¸º â€œanonymous_enable=NOâ€  
åˆ é™¤å¦‚ä¸‹é…ç½®å‰çš„æ³¨é‡Šç¬¦å·(#)ï¼š  
local_enable=YES  
write_enable=YES  
chroot_local_user=YES  
chroot_list_enable=YES  
chroot_list_file=/etc/vsftpd.chroot_list  
:wq ä¿å­˜é€€å‡º
æ¥ç€åˆ›å»ºvsftpd.chroot_listæ–‡ä»¶ï¼Œå¹¶å°†ftpç”¨æˆ·åæ·»åŠ è¿›å»  
#touch /etc/vsftpd.chroot_list && echo ftpuser \> /etc/vsftpd.chroot_list
5.ä¿®æ”¹shellé…ç½®
viç¼–è¾‘/etc/shellsï¼Œå¦‚æœè¯¥æ–‡ä»¶é‡Œæ²¡æœ‰/usr/sbin/nologinæˆ–è€…/sbin/nologinï¼ˆå…·ä½“çœ‹å½“å‰ç³»ç»Ÿé…ç½®ï¼‰åˆ™è¿½åŠ è¿›å»
6.é‡å¯vsftpæœåŠ¡å¹¶æµ‹è¯•ç™»å½•
# service vsftpd restart  
ç„¶åç”¨å¸å·ftpuseræµ‹è¯•ä¸‹æ˜¯å¦å¯ä»¥ç™»é™†ftpã€‚ç›®å½•æ˜¯/home/www/ftproot
ä¸‰ã€vsftpå®‰å…¨é…ç½®
å‰é¢é…ç½®äº†ç”¨æˆ·è®¿é—®æƒé™ç®¡ç†ä¸­çš„ä½¿ç”¨nologinç¦æ­¢FTPå¸æˆ·ç™»å½•LinuxæœåŠ¡å™¨ï¼Œç°åœ¨å†é…ç½®äº›æ›´å®‰å…¨çš„ã€‚
1.é™åˆ¶æ¶æ„å æœ‰å¸¦å®½çš„ç”¨æˆ·
åœ¨vsftpä¸­ï¼ŒåŒ¿åç”¨æˆ·å’Œæœ¬åœ°ç”¨æˆ·çš„é€Ÿåº¦é™åˆ¶æ˜¯åˆ†å¼€çš„ã€‚å‰è€…æ˜¯anon_max_rateï¼Œåè€…æ˜¯local_max_rateã€‚ å®ƒä»¬çš„å•ä½éƒ½æ˜¯byteï¼ˆå­—èŠ‚ï¼‰ã€‚
å¦‚æœè®©åŒ¿åç”¨æˆ·å’Œæœ¬åœ°çš„ç”¨æˆ·éƒ½ä»¥æœ€é«˜300KBçš„é€Ÿåº¦ä¸‹è½½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°å­—åº”è¯¥æ˜¯1024Ã—300=307200ã€‚åœ¨vsftpd.confæ–‡ä»¶æœ«å°¾ä¸­åŠ å…¥ä¸‹é¢çš„ä¸¤è¡Œå³å¯ï¼š
anon_max_rate=307200  
local_max_rate=307200
ç„¶åé‡å¯vsftpdæœåŠ¡å³å¯ã€‚
å¦å¤–ï¼Œè¿˜å¯ä»¥é™åˆ¶FTPçš„æœ€å¤§è¿æ¥æ•°å’Œæ¯ä¸ªIPçš„æœ€å¤§è¿æ¥æ•°ã€‚è¿™ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯Max_clientså’ŒMax_per_ipã€‚å’Œä¸Šé¢ä¸€æ ·ï¼Œä¹Ÿåªéœ€è¦åœ¨vsftpd.confæ–‡ä»¶æœ«å°¾æ·»åŠ å‚æ•°å³å¯ï¼Œå¦‚ä¸‹è®¾æˆäº†æœ€å¤§è¿æ¥æ•°100ï¼Œæ¯ä¸ªIPçš„æœ€å¤§è¿æ¥æ•°5ä¸ªï¼š
max_clients=100  
max_per_ip=5
2.é˜²æ­¢FTPå¯†ç è¢«æ¶æ„å—…æ¢
ç”±äºvsftpdå‘é€çš„æ•°æ®æ˜¯ä»¥æ˜æ–‡æ–¹å¼ä¼ è¾“ï¼Œå°¤å…¶æ˜¯å¯†ç å®¹æ˜“è¢«æ¶æ„çš„å—…æ¢ï¼ˆSnifferingï¼‰åˆ°ï¼Œæ‰€ä»¥é€šå¸¸éœ€è¦é‡‡ç”¨SSLï¼ˆSecure Sockets Layerï¼Œå®‰å…¨å¥—æ¥å­—å±‚ï¼‰æŠ€æœ¯ï¼Œä½¿å¾—vsftpdæ”¯æŒSSLåŠ å¯†ä¼ è¾“ï¼Œä»¥æ­¤æ¥æŠµå¾¡æ¶æ„å—…æ¢æ”»å‡»ã€‚
ä½¿ç”¨SSLæŠ€æœ¯ï¼Œä¾èµ–äºå¦å¤–ä¸€ä¸ªè½¯ä»¶ï¼šOpenSSLï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä»¥è‡ªç”±ä½¿ç”¨çš„SSLå®ç°ï¼Œé¦–å…ˆéœ€è¦å®‰è£…è¿™ä¸ªè½¯ä»¶ã€‚ç”¨æˆ·å¯ä»¥ä»ç½‘ç«™Â http://www.openssl.org/source/ä¸Šä¸‹è½½Linuxä¸‹OpenSSLçš„ç¨³å®šç‰ˆæœ¬ï¼Œç¼–è¯‘å®‰è£…ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤ç”Ÿæˆå¯†é’¥ã€‚
# wget http://www.openssl.org/source/openssl-1.0.1f.tar.gz  
#tar -xvzf openssl-1.0.1f.tar.gz  
#cd openssl-1.0.1f  
#./config  
#make  
#make install
å®‰è£…æˆåŠŸï¼  

æ¥ä¸‹æ¥å¼€å§‹ç”Ÿæˆå¯†é’¥
1.æ£€æŸ¥/etc/ssl/privateÂ ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨å°±åˆ›å»º
mkdir -p /etc/ssl/private  
chmod 700 /etc/ssl/private
2.æ‰§è¡Œå‘½ä»¤ç”Ÿæˆå¯†é’¥
# openssl req -x509 -nodes -days 365 -newkey rsa:1024 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem
3.ä¿®æ”¹vsftpdé…ç½®æ–‡ä»¶
# vi /etc/vsftpd.conf  
åœ¨æœ«å°¾å¢åŠ å¦‚ä¸‹ä»£ç 


33
# Turn on SSL
ssl_enable=YES
Â 
# Allow anonymous users to use secured SSL connections
allow_anon_ssl=YES
Â 
# All non-anonymous logins are forced to use a secure SSL connection in order to
# send and receive data on data connections.
force_local_data_ssl=YES
force_anon_data_ssl=YES
Â 
# All non-anonymous logins are forced to use a secure SSL connection in order to send the password.
force_local_logins_ssl=YES
force_anon_logins_ssl=YES
Â 
# Permit TLS v1 protocol connections. TLS v1 connections are preferred
ssl_tlsv1=YES
Â 
# Permit SSL v2 protocol connections. TLS v1 connections are preferred
ssl_sslv2=NO
Â 
# permit SSL v3 protocol connections. TLS v1 connections are preferred
ssl_sslv3=NO
Â 
# Disable SSL session reuse (required by WinSCP)
require_ssl_reuse=NO
Â 
# Select which SSL ciphers vsftpd will allow for encrypted SSL connections (required by FileZilla)
ssl_ciphers=HIGH
Â 
# This option specifies the location of the RSA certificate to use for SSL
# encrypted connections.
rsa_cert_file=/etc/ssl/private/vsftpd.pem
Â 

ç„¶åé‡å¯vsftp  
#service vsftpd restart




